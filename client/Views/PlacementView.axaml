<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:client.ViewModels"
             xmlns:m="clr-namespace:client.Models"
             x:DataType="vm:PlacementViewModel"
             x:Class="client.Views.PlacementView">
  <Grid ColumnDefinitions="*,220" Margin="16">
    <Grid Grid.Column="0" RowDefinitions="Auto,Auto,Auto">
    <StackPanel>
      <TextBlock Text="Ð Ð°ÑÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° ÐºÐ¾Ñ€Ð°Ð±Ð»ÐµÐ¹" FontSize="24" FontWeight="Bold" Margin="0,0,0,8"/>
      <TextBlock Text="{Binding Status}" Margin="0,0,0,8"/>
      <TextBlock Text="{Binding Room.Name, StringFormat='ÐšÐ¾Ð¼Ð½Ð°Ñ‚Ð°: {0}'}" Margin="0,0,0,4"/>
      <TextBlock Text="{Binding Room.Id, StringFormat='ID ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñ‹: {0}'}" FontSize="10" Opacity="0.7"/>

      <StackPanel Orientation="Horizontal" Margin="0,8,0,0" Spacing="16">
        <StackPanel>
          <TextBlock Text="ÐžÑ€Ð¸ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ" FontWeight="Bold"/>
          <StackPanel Orientation="Horizontal" Spacing="8">
            <TextBlock Text="{Binding IsHorizontal, StringFormat='Ð“Ð¾Ñ€Ð¸Ð·Ð¾Ð½Ñ‚Ð°Ð»ÑŒÐ½Ð¾: {0}'}"/>
            <Button Content="ÐŸÐ¾Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ" Command="{Binding ToggleOrientationCommand}"/>
          </StackPanel>
        </StackPanel>

        <StackPanel>
          <TextBlock Text="ÐžÑÑ‚Ð°Ð»Ð¾ÑÑŒ ÐºÐ¾Ñ€Ð°Ð±Ð»ÐµÐ¹:" FontWeight="Bold"/>
          <TextBlock Text="{Binding ShipsToPlace4, StringFormat='4-Ð¿Ð°Ð»ÑƒÐ±Ð½Ñ‹Ðµ: {0}'}"/>
          <TextBlock Text="{Binding ShipsToPlace3, StringFormat='3-Ð¿Ð°Ð»ÑƒÐ±Ð½Ñ‹Ðµ: {0}'}"/>
          <TextBlock Text="{Binding ShipsToPlace2, StringFormat='2-Ð¿Ð°Ð»ÑƒÐ±Ð½Ñ‹Ðµ: {0}'}"/>
          <TextBlock Text="{Binding ShipsToPlace1, StringFormat='1-Ð¿Ð°Ð»ÑƒÐ±Ð½Ñ‹Ðµ: {0}'}"/>
        </StackPanel>
      </StackPanel>
    </StackPanel>

    <!-- Ð˜Ð³Ñ€Ð¾Ð²Ð¾Ðµ Ð¿Ð¾Ð»Ðµ 10Ã—10 â€” Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð±Ð»Ð¾Ðº, Ð½Ðµ Ð¿Ñ€Ð¸Ð²ÑÐ·Ð°Ð½ Ðº Ñ€Ð°Ð·Ð¼ÐµÑ€Ñƒ Ð¾ÐºÐ½Ð°; ÐºÐ²Ð°Ð´Ñ€Ð°Ñ‚Ð¸ÐºÐ¸ Ð²Ð¿Ð»Ð¾Ñ‚Ð½ÑƒÑŽ -->
    <Border Grid.Row="1" Width="190" Height="190" BorderBrush="Gray" BorderThickness="1"
            HorizontalAlignment="Left" VerticalAlignment="Top" Margin="0,8,0,0">
      <ItemsControl ItemsSource="{Binding Cells}">
        <ItemsControl.ItemsPanel>
          <ItemsPanelTemplate>
            <UniformGrid Rows="10" Columns="10"/>
          </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>
        <ItemsControl.ItemTemplate>
          <DataTemplate x:DataType="vm:CellViewModel">
            <Border Width="19" Height="19" Margin="0"
                    BorderBrush="Gray" BorderThickness="1"
                    Background="{Binding HasShip, Converter={StaticResource BooleanToBrushConverter}}">
              <Button Background="Transparent" BorderThickness="0"
                      Command="{Binding CellClickCommand}"
                      CommandParameter="{Binding}"/>
            </Border>
          </DataTemplate>
        </ItemsControl.ItemTemplate>
      </ItemsControl>
    </Border>

    <StackPanel Grid.Row="2"
                Orientation="Horizontal"
                HorizontalAlignment="Stretch"
                Margin="0,8,0,0">
      <Button Content="Ð“Ð¾Ñ‚Ð¾Ð² Ðº Ð±Ð¾ÑŽ"
              Command="{Binding ReadyCommand}"
              IsEnabled="{Binding CanPressReady}"
              HorizontalAlignment="Left"
              Margin="0,0,8,0"/>

      <Button Content="Ð’Ñ‹Ð¹Ñ‚Ð¸ Ð² Ð³Ð»Ð°Ð²Ð½Ð¾Ðµ Ð¼ÐµÐ½ÑŽ"
              HorizontalAlignment="Right"
              Command="{Binding BackToMenuCommand}"/>
    </StackPanel>
    </Grid>

    <!-- Ð§Ð°Ñ‚ Ñ ÑÐ¾Ð¿ÐµÑ€Ð½Ð¸ÐºÐ¾Ð¼ -->
    <Border Grid.Column="1" Margin="16,0,0,0" BorderBrush="#E2E8F0" BorderThickness="1" CornerRadius="6" Padding="8"
            MinWidth="200" MaxWidth="220" VerticalAlignment="Stretch">
      <Grid RowDefinitions="Auto,*,Auto">
        <TextBlock Text="ðŸ’¬ Ð§Ð°Ñ‚" FontWeight="Bold" FontSize="14" Margin="0,0,0,6"/>
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="0,0,0,6">
          <ItemsControl ItemsSource="{Binding ChatMessages}">
            <ItemsControl.ItemTemplate>
              <DataTemplate x:DataType="m:ChatMessageItem">
                <Border Margin="0,2" Padding="6,4" CornerRadius="4" MaxWidth="180">
                  <StackPanel>
                    <TextBlock Text="{Binding Sender}" FontSize="10" FontWeight="SemiBold" Opacity="0.9"/>
                    <TextBlock Text="{Binding Text}" FontSize="12" TextWrapping="Wrap"/>
                  </StackPanel>
                </Border>
              </DataTemplate>
            </ItemsControl.ItemTemplate>
          </ItemsControl>
        </ScrollViewer>
        <Grid Grid.Row="2" ColumnDefinitions="*,Auto">
          <TextBox Grid.Column="0" Text="{Binding ChatText}" Watermark="Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ..."
                   IsEnabled="{Binding CanUseChat}" Margin="0,0,6,0" MaxHeight="32"/>
          <Button Grid.Column="1" Content="âž¤" Command="{Binding SendChatCommand}" IsEnabled="{Binding CanUseChat}" Width="36"/>
        </Grid>
      </Grid>
    </Border>
  </Grid>
</UserControl>

